import psycopg2
from config import host, user, password, db_name

try:
    # connect to exist database
    connection = psycopg2.connect(
        host=host,
        user=user,
        password=password,
        database=db_name
    )
    connection.autocommit = True

    # the cursor for perfoming database operations
    # cursor = connection.cursor()

    with connection.cursor() as cursor:
        cursor.execute(
            "SELECT version();"
        )

        print(f"Server version: {cursor.fetchone()}")

    # insert data into a table
    # with connection.cursor() as cursor:
    #     cursor.execute(
    #         """INSERT INTO detail_size (drawing, size) VALUES
    #         ('8ТП.310.007','280х240х4'),('8ТП.310.008-048','1370х270х4'),('8ТП.310.008-050','1372х200х4'),('8ТП.310.008-075','562х350х4'),('8ТП.310.017','380х380х4'),('8ТП.310.017-001','293х380х4'),('8ТП.310.006-009','250х180х4'),('8ТП.154.044','980х120х6'),('8ТП.154.044-001','706х120х6'),('8ТП.154.355.001-005','280х50х4'),('8ТП.154.355.001-076','248х50х4'),('8ТП.346.003-002','1428х300х6'),('8ТП.346.003-018','1004х300х6'),('8ТП.346.005-007','1835х172х6'),('8ТП.140.006','Плазма'),('8ТП.150.012','Плазма'),('8ТП.557.047','240х150х4'),('8ТП.557.097-003','70х70х4'),('8ТП.154.001-018','624х12х4'),('8ТП.154.001-037','1124х12х4'),('8ТП.154.001-038','824х12х4'),('8ТП.154.001-047','424х12х4'),('8ТП.154.355.001-006','160х50х4'),('8ТП.154.355.001-007','130х50х4'),('8ТП.346.007-002','697х60х6'),('8ТП.346.007-003','697х60х6'),('8ТП.160.022-472','1440х65х6'),('8ТП.160.022-473','502х50х6'),('8ТП.160.022-474','1430х65х6'),('8ТП.160.022-475','510х50х6'),('8ТП.310.008-103','770х270х4'),('8ТП.557.022-030','628х74х6'),('8ТП.154.001-004','324х12х4'),('8ТП.154.001-005','724х12х4'),('8ТП.154.001-010','575х12х4'),('8ТП.154.001-019','524х12х4'),('8ТП.154.009-140','50х40х4'),('8ТП.154.355.001','195х50х4'),('8ТП.154.355.024','57х13х4'),('8ТП.154.355.025','124х13х4'),('8ТП.154.355.026','20х150'),('8ТП.346.003-003','480х100х6'),('8ТП.160.002-393','770х100х4'),('8ТП.160.022-560','2732х65х6'),('8ТП.160.022-561','2298х150х6'),('8ТП.160.135-002','113х30х4'),('8ТП.344.059','1217х116х4'),('8ТП.214.001-002','772х40х4'),('8ТП.214.001-006','2091х40х4'),('8ТП.310.006-012','280х240х4'),('8ТП.310.006-036','300х380х4'),('8ТП.310.008-102','572х320х4'),('8ТП.310.026-004','290х240х4'),('8ТП.310.029','248х248х4'),('8ТП.340.152','2589х190х4'),('8ТП.344.889','923х72х4'),('8ТП.154.001-006','274х12х4'),('8ТП.154.001-034','464х12х4'),('8ТП.154.001-051','474х12х4'),('8ТП.154.001-056','444х12х4'),('8ТП.154.009-139','630х50х4'),('8ТП.154.355.001-001','225х50х4'),('8ТП.154.355.001-003','230х50х4'),('8ТП.346.005-002','1080х172х6'),('8ТП.160.001-178','720х93х4'),('8ТП.160.002-391','572х117х4'),('8ТП.160.129-003','110х40х4'),('8ТП.160.146','116х90х6'),('8ТП.160.151','2680х70х6'),('8ТП.505.014-335','878х79х4'),('8ТП.505.014-336','498х62х4'),('8ТП.505.014-337','498х90х4'),('8ТП.214.001','333х40х4'),('8ТП.154.011-762','778х38х6'),('8ТП.346.008','936х100х6'),('8ТП.214.001-004','1652х40х4'),('8ТП.346.003-024','526х100х6'),('8ТП.140.003-001','91х30х4'),('8ТП.140.003-003','56х50х4'),('8ТП.557.019-008','30х20х4'),('8ТП.154.103','2025х59х4'),('8ТП.140.003-016','96х30х4'),('8ТП.140.003-014','66х30х4'),('8ТП.140.003-015','Плазма'),('8ТП.160.015-041','1078х65х6'),('8ТП.160.001-020','470х53х4'),('8ТП.154.011-752','290х26х6'),('8ТП.505.014-333','328х100х4'),('8ТП.505.014-334','328х101х4'),('8ТП.154.009-138','430х50х4'),('8ТП.154.011-749','178х26х6'),('8ТП.154.011-760','470х106х6'),('8ТП.160.001-014','270х53х4'),('8ТП.160.002-323','470х48х4'),('8ТП.160.002-324','180х48х4'),('8ТП.505.026-087','708х170х4'),('8ТП.154.011-738','342х31х6'),('8ТП.154.011-739','342х231х6'),('8ТП.154.011-740','398х31х6'),('8ТП.154.011-741','398х71х6'),('8ТП.160.022-316','470х55х4'),('8ТП.160.022-317','160х55х4'),('8ТП.346.001','620х60х4'),('8ТП.346.001-001','620х60х4'),('8ТП.046.001','535х60х4'),('8ТП.310.001','280х240х4'),('8ТП.150.013-001','Плазма'),('8ТП.154.001-002','624х12х4'),('8ТП.154.001-014','1625х12х4'),('8ТП.154.001-017','924х12х4'),('8ТП.154.001-046','375х12х4'),('8ТП.154.009-002','80х30х4'),('8ТП.505.014-331','678х99х4'),('8ТП.505.014-332','678х111х4'),('8ТП.140.009-001','85х30х5'),('8ТП.160.022-559','2512х65х6'),('8ТП.160.005','228х73х4'),('8ТП.310.006-002','250х442х4'),('8ТП.557.009','80х30х4'),('8ТП.154.001-021','1425х12х4'),('8ТП.154.001-045','1024х12х4'),('8ТП.346.001-025','1252х60х4'),('8ТП.160.001-007','600х53х4'),('8ТП.160.002-394','1306х93х4'),('8ТП.160.007','58х30х4'),('8ТП.160.022-562','865х50х6'),('8ТП.160.022-563','1300х50х6'),('8ТП.160.022-564','1450х50х6'),('8ТП.214.001-013','458х40х4'),('8ТП.310.008-071','752х400х4'),('8ТП.557.019','45х30х4'),('8ТП.154.355.001-077','290х50х4'),('8ТП.154.355.001-078','245х50х4'),('8ТП.140.003-004','Плазма'),('8ТП.051.001-082','Плазма'),('8ТП.051.001-083','Плазма'),('8ТП.180.003-224','Плазма'),('8ТП.505.864','Плазма'),('8ТП.310.010','Плазма'),('8ТП.160.003-006','Плазма'),('8ТП.160.003-042','Плазма'),('8ТП.160.003-144','Плазма'),('8ТП.160.010-009','Плазма'),('8ТП.160.010-025','Плазма'),('8ТП.160.062-009','Плазма'),('8ТП.140.011','Плазма'),('8ТП.322.005-001','Плазма'),('8ТП.322.005-002','Плазма'),('8ТП.046.006','Плазма'),('8ТП.046.008-001','Плазма'),('8ТП.340.010-001','Плазма'),('8ТП.340.010-004','Плазма'),('8ТП.000.001-037','Плазма'),('8ТП.000.001-072','Плазма'),('8ТП.505.003-187','Плазма'),('8ТП.505.007-379','Плазма'),('8ТП.505.008-799','Плазма'),('8ТП.505.008-800','Плазма'),('8ТП.505.016-097','Плазма'),('8ТП.180.052-014','Плазма'),('8ТП.046.010','Плазма'),('8ТП.344.244-052','Плазма'),('8ТП.344.836','Плазма'),('8ТП.322.005-003','Плазма'),('8ТП.000.001-024','Плазма'),('8ТП.344.604-024','Плазма'),('8ТП.344.604-025','Плазма'),('8ТП.505.079-033','Плазма'),('8ТП.505.165-030','Плазма'),('8ТП.505.166-019','Плазма'),('8ТП.505.189-044','Плазма'),('8ТП.505.599-002','Плазма'),('8ТП.160.003-183','Плазма'),('8ТП.160.010-003','плазма'),('8ТП.160.010-102','Плазма'),('8ТП.160.066','Плазма'),('8ТП.160.066-001','Плазма'),('8ТП.160.067','Плазма'),('8ТП.160.068','Плазма'),('8ТП.180.019-016','Плазма'),('8ТП.180.035-114','Плазма'),('8ТП.180.035-140','Плазма'),('8ТП.180.035-167','Плазма'),('8ТП.166.089','Плазма'),('8ТП.557.536','Плазма'),('8ТП.505.165-028','Плазма'),('8ТП.505.165-029','Плазма'),('8ТП.505.188-045','Плазма'),('8ТП.505.188-046','482х236х6'),('8ТП.505.189-042','Плазма'),('8ТП.505.189-043','Плазма'),('8ТП.505.190-005','Плазма'),('8ТП.046.009','Плазма'),('8ТП.051.001-001','плазма'),('8ТП.557.015','Плазма'),('8ТП.140.031','Плазма'),('8ТП.160.003-134','Плазма'),('8ТП.160.010-074','Плазма'),('8ТП.180.003-012','Плазма'),('8ТП.180.003-056','Плазма'),('8ТП.180.003-223','Плазма'),('8ТП.180.019-012','Плазма'),('8ТП.180.035-112','Плазма'),('8ТП.180.035-134','Плазма'),('8ТП.322.021-001','Плазма'),('8ТП.322.021-002','Плазма'),('8ТП.322.021-036','Плазма'),('8ТП.000.001-066','Плазма'),('8ТП.000.004-009','Плазма'),('8ТП.000.004-016','Плазма'),('8ТП.000.007-005','Плазма'),('8ТП.046.003','Плазма'),('8ТП.046.009-008','Плазма'),('8ТП.340.001-200','Плазма'),('8ТП.340.151','Плазма'),('8ТП.051.001','Плазма'),('8ТП.557.020-050','Плазма'),('8ТП.557.020-054','Плазма'),('8ТП.505.001-058','Плазма'),('8ТП.505.005-239','Плазма'),('8ТП.505.007-412','Плазма'),('8ТП.505.008-874','Плазма'),('8ТП.505.017-170','Плазма'),('8ТП.505.017-171','Плазма'),('8ТП.505.043-048','Плазма'),('8ТП.505.574-001','Плазма'),('8ТП.505.922','Плазма'),('8ТП.505.922-001','Плазма'),('8ТП.505.923','Плазма'),('8ТП.505.924','Плазма'),('8ТП.160.003-029','Плазма'),('8ТП.160.003-152','Плазма'),('8ТП.160.010-085','Плазма'),('8ТП.160.010-088','Плазма'),('8ТП.160.017-012','Плазма'),('8ТП.160.040-020','Плазма'),('8ТП.160.040-021','Плазма'),('8ТП.160.053-059','Плазма'),('8ТП.160.062-012','Плазма'),('8ТП.160.147-001','Плазма'),('8ТП.160.148','Плазма'),('8ТП.160.149','Плазма'),('8ТП.160.149-001','Плазма'),('8ТП.160.150','Плазма'),('8ТП.160.150-001','Плазма'),('8ТП.160.003-180','Плазма'),('8ТП.160.010-099','Плазма'),('8ТП.180.003-121','Плазма'),('8ТП.180.003-220','Плазма'),('8ТП.180.003-246','Плазма'),('8ТП.180.003-253','Плазма'),('8ТП.180.035-161','Плазма'),('8ТП.180.035-162','Плазма'),('8ТП.180.302','Плазма'),('8ТП.180.303','Плазма'),('8ТП.340.150','Плазма'),('8ТП.340.150-001','Плазма'),('8ТП.505.930','Плазма'),('8ТП.000.001-064','Плазма'),('8ТП.000.007-006','Плазма'),('8ТП.046.003-003','Плазма'),('8ТП.340.037-006','Плазма'),('8ТП.340.153','Плазма'),('8ТП.340.154','Плазма'),('8ТП.340.008','Плазма'),('8ТП.150.125','Плазма'),('8ТП.557.020-043','Плазма'),('8ТП.505.003-217','Плазма'),('8ТП.505.003-218','Плазма'),('8ТП.505.003-219','Плазма'),('8ТП.505.028-028','Плазма'),('8ТП.505.925','Плазма'),('8ТП.505.926','Плазма'),('8ТП.505.927','Плазма'),('8ТП.505.929','Плазма'),('8ТП.505.044','Плазма'),('8ТП.505.044-001','Плазма'),('8ТП.505.045','Плазма'),('8ТП.160.010-005','Плазма'),('8ТП.160.017-004','Плазма'),('8ТП.160.047-035','Плазма'),('8ТП.160.047-036','Плазма'),('8ТП.160.047-037','Плазма'),('8ТП.160.047-038','Плазма'),('8ТП.160.053-060','Плазма'),('8ТП.160.152','Плазма'),('8ТП.160.152-001','Плазма'),('8ТП.160.153','Плазма'),('8ТП.160.153-001','Плазма'),('8ТП.160.154-001','Плазма'),('8ТП.160.165','Плазма'),('8ТП.160.165-001','Плазма'),('8ТП.180.003-134','Плазма'),('8ТП.180.027','Плазма'),('8ТП.180.304','Плазма'),('8ТП.166.088','Плазма'),('8ТП.160.164','Плазма'),('8ТП.000.001-139','Плазма'),('8ТП.000.017','Плазма'),('8ТП.051.001-074','Плазма'),('8ТП.505.122-059','Плазма'),('8ТП.505.165-031','Плазма'),('8ТП.505.920','Плазма'),('8ТП.505.920-001','Плазма'),('8ТП.505.921','Плазма'),('8ТП.160.025-100','Плазма'),('8ТП.180.003-252','Плазма'),('8ТП.046.003-024','Плазма'),('8ТП.046.009-002','Плазма'),('',''),('8ТП.051.001-003','Плазма'),('8ТП.160.010-098','Плазма'),('8ТП.180.003-009','Плазма'),('8ТП.180.003-010','Плазма'),('8ТП.051.001-065','Плазма'),('8ТП.180.035-059','Плазма'),('8ТП.180.063-002','Плазма'),('8ТП.180.063-012','Плазма'),('АМБЕ.8ТП.557.015','Плазма'),('АМБЕ.8ТП.180.035-180','Плазма'),('АМБЕ.8ТП.180.035-181','Плазма'),('8ТП.180.063-045','Плазма'),('8ТП.000.001-034','Плазма'),('8ТП.000.001-059','Плазма'),('8ТП.000.001-087','Плазма'),('АМБЕ.8ТП.051.001-007','Плазма'),('8ТП.505.005-240','Плазма'),('8ТП.505.008-876','Плазма'),('8ТП.505.008-877','Плазма'),('8ТП.505.157-004','Плазма'),('8ТП.505.325-006','Плазма'),('8ТП.505.325-007','Плазма'),('АМБЕ.8ТП.505.937','Плазма'),('АМБЕ.8ТП.505.937-001','Плазма'),('8ТП.160.003-014','Плазма'),('8ТП.160.003-116','Плазма'),('8ТП.160.003-186','Плазма'),('8ТП.160.010-010','Плазма'),('8ТП.160.010-061','Плазма'),('8ТП.160.026-001','Плазма'),('АМБЕ.8ТП.160.162','Плазма'),('АМБЕ.8ТП.160.162-001','Плазма'),('8ТП.180.003-128','Плазма'),('8ТП.180.040','Плазма'),('8ТП.180.064-006','Плазма'),('8ТП.180.153-014','Плазма'),('8ТП.214.001-005','1934х40х4'),('8ТП.310.006-008','300х300х4'),('8ТП.310.008-104','650х400х4'),('8ТП.154.001-029','1025х12х4'),('8ТП.154.001-030','775х12х4'),('8ТП.154.009-134','1240х30х4'),('8ТП.154.009-135','70х30х4'),('8ТП.505.076-089','1082х98х6'),('8ТП.160.015-032','2686х49х6'),('8ТП.160.022-483','1198х220х6'),('8ТП.160.022-484','2487х105х6'),('8ТП.160.022-485','2700х94х6'),('8ТП.160.022-486','1285х69х6'),('8ТП.160.022-487','1285х7100х6')
    #         ;"""
    #     )
    #
    # print("[INFO] Data was succefully inserted")

except Exception as _ex:
    print("[INFO] Error while working with PostgreSQL", _ex)
finally:
    if connection:
        # cursor.close()
        connection.close()
        print("[INFO] PostgreSQL connection closed")